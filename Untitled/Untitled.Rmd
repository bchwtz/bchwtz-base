---
title: "term paper - statistics"
abstract: "Due to Germany's history a disequilibrium between its western and eastern states was a common topic for which a solidarity tax was payed a long time. Are there still any financial differences of the human's life in the west compared to the east? In order to answer this question or to get an idea, a housing data set will be analysed concerning the geography and time."
keywords: "Statistics, Regression, Forecasting"

course: Statistics (Prof. Dr. Buchwitz)
supervisor: Prof. Dr. Buchwitz
city: Meschede

# List of Authors
author:
- familyname: Behrens
  othernames: Hannah
  address: "MatNr: xx"
  qualifications: "M.Sc."
  email: behrens.hannah@fh-swf.de
  correspondingauthor: true

# Language Options
german: false # German Dummy Text
lang: en-gb   # Text Language: en-gb, en-us, de-de

# Indexes
toc: true     # Table of Contents
lot: false    # List of Tables
lof: false    # List of Figures

# Output Options
bibliography: references.bib
biblio-style: authoryear-comp
blind: false
cover: true
checklist: true
output:
  fhswf::seminarpaper:
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    keep_tex: no
    number_sections: yes
    citation_package: biblatex
knit: fhswf::render_seminarpaper
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=FALSE, messages=FALSE, warning=FALSE)

# Load Packages
library(ggplot2)
library(knitr)
library(dplyr)
```


# Introduction

## Context

Germany's history: separation of Germany in West and East
([DDR 1949-1990](https://de.wikipedia.org/wiki/Deutsche_Demokratische_Republik))\newline
missing financial support/investigations in the eastern states concerning e.g. its infrastructure/housing\newline
$\rightarrow$ as a cause: different living conditions

[Since 1990: adaptation of *new states* (East)](https://de.wikipedia.org/wiki/Neue_L%C3%A4nder):

- Brandenburg
- Sachsen
- Sachsen-Anhalt
- Thüringen
- Mecklenburg-Vorpommern

$\rightarrow$ reunion: Federal Republic of Germany

After Germany's reunion, a solidarity tax has been payed in order to balance the drawbacks in East-Germany.

## Research Question

Hypothesis:\newline
Despite the solidarity tax there is still a significant difference concerning the housing prices in the west vs. east.\newline
Or in other words, the research question is: Does a significant difference concerning the housing prices between the east and west of Germany still exist which can be possibly seen as a remnant of Germany's separation?

Therefore, the temporal development of houseprices are of interest.

+ assumption: no increase in housing prices with increasing years, i.e. no inflation, will be considered

+ increases in value due to e.g. reduction of living space are not considered


## Paper Structure

In order to answer the research question and to examine the mentioned hypotheses respectively, the different states have to be marked: This means, which state belongs to the former eastern states and which is mapped to the west?\newline
Therefore, some variables such as **id**, **price**, **year_construction** and **state** will be picked off. Furthermore, the [German housing data set](https://www.kaggle.com/scriptsultan/german-house-prices) has to be modified by introducing a further (categorical) variable which is called **location** and which gives information about west/east-affiliation.

In order to examine if there is a significant difference between the housing prices in west and east germany, a t-test will be performed.


# Data 

```{r load-data, message=FALSE, warning=FALSE, echo=TRUE}
# Load data
x <- read.csv("https://bchwtz.github.io/bchwtz-stat/data/2021_fhswf_stat_housing.csv")

# Structure of selected variables of the housing-data set
head(data.frame(x$id, x$price, x$year_construction, x$state))
```

The file consists of ```r nrow(x)``` observations and ```r ncol(x)``` variables. 

# Methodology

## Data manipulation

```{r data-manipulation-1, echo=TRUE}
# remove the row in which no state is listed:
x2<-x[-which(x$state==""),]

## Data manipulation:
x2$state<-gsub("Ã¼", "ue", x2$state)
```


```{r west-east-states, echo=TRUE}
east_states<-c("Brandenburg", "Sachsen", "Sachsen-Anhalt", 
               "Thueringen", "Mecklenburg-Vorpommern")

# introducing the categorical variable "location":
x2$location<-0
x2$location[which(x2$state %in% east_states)]<-"east"
x2$location[which(!x2$state %in% east_states)]<-"west"

x3<-x2[which(x2$year_construction>=1949),] 

# house prices of 0 | 1 make no sense 
# --> remove the corresponding observations
x3<-x3[which(x3$price>1),]

x3_extract<-data.frame(x3$id, x3$price, x3$year_construction, 
                      x3$state, x3$location)
colnames(x3_extract)<-c("id", "price", "yc", "state", "location")

# separate into west and east
x3_west<-x3_extract[which(x3_extract$location=="west"),]
x3_east<-x3_extract[which(x3_extract$location=="east"),]

## annual housing prices
# in the west
x3_west_mean<-x3_west %>%
  group_by(yc) %>%
  summarise(m = mean(price))

# in the east
x3_east_mean<-x3_east %>%
  group_by(yc) %>%
  summarise(m = mean(price))

comb<-x3_east_mean %>%
  left_join(x3_west_mean, by="yc", suffix=c("_east", "_west"))
```

In total, ```r nrow(x3)``` observations exist. Most of them are part of **West-Germany** (```r nrow(x3_west)```). Only ```r nrow(x3_east)``` observations belong to **East-Germany**.

## Summary of prices

```{r summary-prices}
# summary of "raw" data
east<-x3_east[,2]
west<-x3_west[,2]
east_summary<-summary(east)
west_summary<-summary(west)
ls<-list(east_summary, west_summary)
names(ls)<-c("east_summary", "west_summary")
ls
```

```{r summary-prices2, echo=TRUE}
# annual housing prices
comb2<-comb[,2:3]
colnames(comb2)<-c("mean_annual_east", "mean_annual_west")
lapply(comb2, summary)
```

## Plot the data

```{r plot-prices, fig.cap="Raw data of housing prices in the west and east of Germany."}
ggplot(x3, aes(x=year_construction, y=price, color=location))+
  geom_point()+
  labs(x="Year",
      y = "Price in €",
      title = "Housing-prices from 1949 to today")
```

```{r, plot-prices-mean, fig.cap="Annual housing prices."}

ggplot()+
  geom_line(data=comb, aes(x=yc, y=m_east, colour="East"))+
  geom_line(data=comb, aes(x=yc, y=m_west, colour="West"))+
  labs(x="Year",
      y = latex2exp::TeX("$\\bar{x}$ (Price in €)"),
      title = "Housing-prices from 1949 to today")+
  scale_color_manual(name = "Location", values = c("East" = "red", "West" = "blue"))
```

```{r, echo=FALSE}
mean_x<-c(mean(comb$m_east), mean(comb$m_west))
sd_x<-c(sd(comb$m_east), sd(comb$m_west))
mean_sd<-rbind(mean_x, sd_x)
colnames(mean_sd)<-c("prices_east", "prices_west")
```

```{r mean-sd-table}
kable(mean_sd, caption="Mean and standard deviation of annual housing prices after applying left join.")
```

$\rightarrow$ obvious differences can be seen from Figures \@ref(fig:plot-prices) and \@ref(fig:plot-prices-mean) as well as from Table \@ref(tab:mean-sd-table).

\newpage

# Analysis

**t-test**

$H_{0}$: no difference concerning the housing prices in West- and East-Germany

$H_{A}$: the housing prices in West-Germany are \emph{really}/\emph{much higher} compared to those in East-Germany or the other way around: the housing-prices in East-Germany are \emph{much lower} than those in West-Germany, so there is a *real*/*significant* difference

$\alpha$ = 0.05 (5 \%) $\rightarrow$ $\frac{\alpha}{2}= 0.025$

```{r t-test-housing, echo=TRUE}
# Two-sided t-test based on the annual housing prices: 1949-today
tt<-t.test(x=comb$m_east, y=comb$m_west, alternative = "two.sided")
tt

```

```{r after-1990, echo=TRUE}
comb_1990<-comb[which(comb$yc>=1990),]

# Two-sided t-test based on the annual housing prices: 1990-today
tt_1990<-t.test(x=comb_1990$m_east, y=comb_1990$m_west, 
                alternative = "two.sided")
tt_1990
```

\begin{itemize}
\item[1.)] |t-value|, i.e. 8.6705 and 4.9389 are both > $t_{n=100,0.975}=1.984$ \item[2.)] $\frac{\alpha}{2} < 1.597 \cdot 10^{-14}$, $\frac{\alpha}{2} < 6.554 \cdot 10^{-6}$ 
\end{itemize}

$\rightarrow$ rejection of $H_{0}$, i.e. *significant* difference in annual housing prices

# Discussion (manually added)

For a *detailed* analysis further factors such as the following ones have to be taken into account:

+ So far, no inflation which can vary in the diverse (western/eastern) states has been considered. This can be an explanation for the high difference in the means.

+ the different size of the houses, differences in any governmental grants which result in differences concerning the house prices, the *geographic* distributions of houses in villages/cities in the west/east have to be considered and further ones which may have an impact on the presented results.

+ disequilibrium between the number of observations in the west vs. east of Germany\newline
$\rightarrow$ $\frac{6135\;obs.}{11\;states}=557.7273\, \frac{obs.}{state}$ vs. $\frac{856\;obs.}{5\;states}=171.2\,\frac{obs.}{state}$

Instead of using the yearly means in order to compare the housing prices in the west and east of Germany, the median, which is a robust parameter, is possibly more suitable.

# Conclusion

In the analysed data set, there is a significant difference in the annual housing prices between West- and East-Germany in the range from 1949 to today as well as after 1990. Consequently, the houses in West-Germany are still much more expensive than those in the east.\newline
Nevertheless, there are some more criteria which have not been considered so far. 

\vspace{2cm}

```{r, echo=T, eval=F}
# Language Options
german: true
lang: de-de 
```


# Outlook - further data sets (added manually)

## What to do in the future?

+ How can the large increases in housing prices in the east of Germany in 1955 as well as in 2002 be possibly explained?

+ taking into account the mentioned factors

## Further data sets for other examinations

+ R package \texttt{housingData} $\rightarrow$ \texttt{housing} data set

+ R package \texttt{fpp3}: different data sets such as \texttt{prices}, \texttt{boston\_marathon}

[overview of diverse R packages with data sets](https://stat.ethz.ch/R-manual/R-devel/library/data sets/html/00Index.html)

## Further information - literature:

+ [How to write texts in R Markdown](https://bookdown.org/yihui/rmarkdown-cookbook/)

\newpage
\singlespacing

# Technical Appendix {-}

```{r, echo = TRUE}
Sys.time()
sessionInfo()
```

